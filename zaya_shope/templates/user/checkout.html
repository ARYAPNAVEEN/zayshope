{% extends 'user/base.html' %}
{% load static %}

{% block content %}
<div class="container py-5">
  <div class="row g-4">
    <form method="POST" action="{% url 'checkout' %}" class="d-flex">
      {% csrf_token %}

          <div class="card shadow-sm col-lg-8">
              <h4> Delivery Address</h4>
              {% for address in addresses %}
               
                <div class="border rounded-3 p-3 mb-3 bg-light">
                  <input class="form-check-input" type="radio" name="address" id="online" value="{{address.id}}" required>
                  <p class="mb-1"><strong>Address:</strong> {{ address.main_address }}</p>
                  <p class="mb-1"><strong>Phone:</strong> {{ address.phone }}</p>
                  <p class="mb-1"><strong>City:</strong> {{ address.city }}</p>
                  <p class="mb-1"><strong>State:</strong> {{ address.state }}</p>
                  <p class="mb-0"><strong>Pincode:</strong> {{ address.pincode }}</p>
                  <a href="{% url 'edit_address' address.id %}" class="btn btn-outline-primary btn-sm rounded-pill px-3">
                    Edit
                  </a>
                </div>
              {% endfor %}
              <div class="card shadow-sm w-50">
                <button type="button" class="btn btn-success" 
                        data-bs-toggle="modal" data-bs-target="#add_address">
                    Add Address
                </button>
              </div>
          </div>
        


        

          <!-- Payment & Place Order -->
          <div class="col-lg-4 ms-4"  >
            <div class="card shadow-lg border-0 rounded-4 p-4">
              <h5 class="fw-bold mb-3">Payment Method</h5>
              <div class="mb-3">
                <select class="form-select shadow-sm border-1 rounded-3" name="payment_method" required>
                  <option value="" >Select a payment method</option>
                  {% for method in payment_methods %}
                    <option value="{{ method }}">{{ method }}</option>
                  {% endfor %}
                </select>
              </div>
              
              <h5 class="fw-bold mb-3">Order Summary</h5>
              <div class="d-flex justify-content-between text-success fw-bold">
                <span>ExactTotal </span>
                <span>₹{{ cart.exact_total }}</span>
              </div>
              <div class="d-flex justify-content-between text-success fw-bold">
                <span>your saving</span>
                <span>₹{{ cart.saving }}</span>
              </div>
              <hr>
              <div class="d-flex justify-content-between">
                <span>Total</span>
                <span>₹{{ cart.total }}</span>
              </div>
              <div class=" justify-content-between">
               <button type="submit" class="btn btn-success w-100 py-2 fw-bold">place order<button>
              </div>
          </div>
        </div>
    </form>


          {% comment %} add_address modal {% endcomment %}

      <div class="modal fade" id="add_address" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content" style="border-radius: 20px; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: none; box-shadow: 0 10px 25px rgba(0,0,0,0.1);">

            <div class="modal-header border-0">
              <h5 class="modal-title">Add New Address</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <form action="{% url 'add_address' %}" method="POST">
              {% csrf_token %}
              <div class="modal-body">

                <div class="mb-3">
                  <label class="form-label">Main Address</label>
                  <input class="form-control" name="main_address" required>
                </div>

                <div class="mb-3">
                  <label class="form-label">Phone Number</label>
                  <input class="form-control" name="phone" required>
                </div>

                <div class="mb-3">
                  <label class="form-label">City</label>
                  <input class="form-control" name="city" required>
                </div>

                <div class="mb-3">
                  <label class="form-label">State</label>
                  <input class="form-control" name="state" required>
                </div>

                <div class="mb-3">
                  <label class="form-label">Pincode</label>
                  <input class="form-control" name="pincode" required>
                </div>

              </div>

              <div class="modal-footer border-0">
                <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-success">Add Address</button>
              </div>

            </form>

          </div>
        </div>
      </div>


  </div>
</div>





{% endblock %}
