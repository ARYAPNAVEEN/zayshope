{% extends 'user/base.html' %}
{% load static %}

{% block content %}
<div class="container py-4">
    <h3 class="mb-4 text-center fw-bold">My Orders</h3>

    {% for item in order %}
    <div class="order-card shadow-sm rounded-4 mb-4 p-0">

        <!-- Header -->
        <div class="order-header d-flex justify-content-between align-items-center px-4 py-3">
            <h5 class="fw-semibold m-0">Order ID: #000000{{ item.id }}</h5>
            <span class="fw-semibold">{{ item.created_at|date:"M d, Y" }}</span>
        </div>

        <!-- Body -->
        <div class="row g-0 p-4 align-items-center">
          
            <!-- LEFT DETAILS -->
            <div class="col-md-4">
                <p class="m-0"><strong>Date:</strong> {{ item.created_at|date:"M d, Y" }}</p>
                <p class="mt-2 m-0">
                    <strong>Total:</strong> â‚¹{{ item.total }}
                </p>
                <p class="mt-2 m-0">
                    <strong>Status:</strong> {{ item.status }}
                </p>
                
            </div>
            


            <!-- CENTER -->
            <div class="col-md-4 text-center">
                <p class="mt-1 w-50 m-0 d-inline ">
                    <strong>Est. Delivery:</strong> {{ expected_delivery }}
                </p>
                <a href="{% url 'order_summary' item.id %}"
                   class="btn btn-outline-success px-4 py-2 rounded-pill mt-2">
                    View Summary
                </a>
                {% if item.status != "Cancelled" and item.status != "Delivered" %}
                    <a href="{% url 'cancel_order' item.id %}" 
                    class="btn btn-outline-danger px-4 py-2 rounded-pill mt-1">
                        Cancel Order
                    </a>
                {% endif %}
            </div>

            <!-- RIGHT IMAGES -->
            <div class="col-md-4 d-flex justify-content-end">
                {% for order_item in item.orderitems_set.all %}
                    {% if forloop.counter <= 2 %}
                        <img src="{{ order_item.product.image.url }}" 
                             class="order-img rounded-3 ms-2">
                    {% endif %}
                {% endfor %}
            </div>
         
        </div>
    </div>
    {% empty %}
    <p class="text-center">No orders found.</p>
    {% endfor %}
</div>

{% endblock %}
